databaseChangeLog:
- changeSet:
    id: DP-0001-1_00_initiateTag
    author: daniel
    changes:
    - tagDatabase:
        tag: DP-0001-1
- changeSet:
    id: DP-0001-1_01_createType-merchant_status
    author: daniel
    changes:
    - sql:
        sql: >
          CREATE TYPE "merchant_status" AS ENUM ('ACTIVE', 'INACTIVE', 'DELETED');
          COMMENT ON TYPE "merchant_status" IS 'Enumeration for merchant status.';
    rollback:
    - sql:
        sql: DROP TYPE "merchant_status" CASCADE;
- changeSet:
    id: DP-0001-1_02_createType-register_status
    author: daniel
    changes:
    - sql:
        sql: >
          CREATE TYPE "register_status" AS ENUM ('ACTIVE', 'INACTIVE', 'DELETED');
          COMMENT ON TYPE "register_status" IS 'Enumeration for register status.';
    rollback:
    - sql:
        sql: DROP TYPE "register_status" CASCADE;
- changeSet:
    id: DP-0001-1_03_createType-inquiry_status
    author: daniel
    changes:
    - sql:
        sql: >
          CREATE TYPE "inquiry_status" AS ENUM ('SUCCESS', 'FAILED', 'USED');
          COMMENT ON TYPE "inquiry_status" IS 'Enumeration for register status.';
    rollback:
    - sql:
        sql: DROP TYPE "inquiry_status" CASCADE;
- changeSet:
    id: DP-0001-1_04_createType-payment_status
    author: daniel
    changes:
    - sql:
        sql: >
          CREATE TYPE "payment_status" AS ENUM ('SUCCESS', 'FAILED');
          COMMENT ON TYPE "payment_status" IS 'Enumeration for register status.';
    rollback:
    - sql:
        sql: DROP TYPE "payment_status" CASCADE;
- changeSet:
    id: DP-0001-1_05_createTable-merchant
    author: daniel
    changes:
    - createTable:
        tableName: merchant
        columns:
        - column:
            name: id
            type: BIGINT
            autoIncrement: true
            constraints:
              primaryKey: true
              primaryKeyName: pk_merchant
              nullable: false
        - column:
            name: name
            type: VARCHAR(128)
            constraints:
              nullable: false
        - column:
            name: client_id
            type: VARCHAR(32)
            constraints:
              nullable: false
        - column:
            name: client_secret
            type: VARCHAR(256)
            constraints:
              nullable: false
        - column:
            name: status
            type: merchant_status
            constraints:
              nullable: false
        - column:
            name: created_date
            type: TIMESTAMP WITH TIME ZONE
            defaultValueComputed: CURRENT_TIMESTAMP
        - column:
            name: updated_date
            type: TIMESTAMP WITH TIME ZONE
- changeSet:
    id: DP-0001-1_06_createTable-register
    author: daniel
    changes:
    - createTable:
        tableName: register
        columns:
        - column:
            name: id
            type: BIGINT
            autoIncrement: true
            constraints:
              primaryKey: true
              primaryKeyName: pk_register
              nullable: false
        - column:
            name: merchant_id
            type: BIGINT
            constraints:
              nullable: false
              foreignKeyName: fk_register_x_merchant
              references: merchant(id)
        - column:
            name: invoice_number
            type: VARCHAR(64)
            constraints:
              nullable: false
        - column:
            name: virtual_account_number
            type: VARCHAR(28)
            constraints:
              nullable: false
        - column:
            name: virtual_account_name
            type: VARCHAR(255)
            constraints:
              nullable: false
        - column:
            name: virtual_account_email
            type: VARCHAR(255)
            constraints:
              nullable: true
        - column:
            name: virtual_account_phone
            type: VARCHAR(30)
            constraints:
              nullable: true
        - column:
            name: amount
            type: NUMERIC(16, 2)
            constraints:
              nullable: false
        - column:
            name: currency
            type: VARCHAR(3)
            constraints:
              nullable: false
        - column:
            name: additional_info
            type: JSONB
            constraints:
              nullable: true
        - column:
            name: status
            type: register_status
            constraints:
              nullable: false
        - column:
            name: created_date
            type: TIMESTAMP WITH TIME ZONE
            defaultValueComputed: CURRENT_TIMESTAMP
        - column:
            name: updated_date
            type: TIMESTAMP WITH TIME ZONE
- changeSet:
    id: DP-0001-1_07_createTable-inquiry
    author: daniel
    changes:
    - createTable:
        tableName: inquiry
        columns:
        - column:
            name: id
            type: BIGINT
            autoIncrement: true
            constraints:
              primaryKey: true
              primaryKeyName: pk_inquiry
              nullable: false
        - column:
            name: merchant_id
            type: BIGINT
            constraints:
              nullable: false
              foreignKeyName: fk_inquiry_x_merchant
              references: merchant(id)
        - column:
            name: register_id
            type: BIGINT
            constraints:
              nullable: false
              foreignKeyName: fk_inquiry_x_register
              references: register(id)
        - column:
            name: invoice_number
            type: VARCHAR(64)
            constraints:
              nullable: false
        - column:
            name: virtual_account_number
            type: VARCHAR(28)
            constraints:
              nullable: false
        - column:
            name: virtual_account_name
            type: VARCHAR(255)
            constraints:
              nullable: false
        - column:
            name: virtual_account_email
            type: VARCHAR(255)
            constraints:
              nullable: true
        - column:
            name: virtual_account_phone
            type: VARCHAR(30)
            constraints:
              nullable: true
        - column:
            name: amount
            type: NUMERIC(16, 2)
            constraints:
              nullable: false
        - column:
            name: currency
            type: VARCHAR(3)
            constraints:
              nullable: false
        - column:
            name: additional_info
            type: JSONB
            constraints:
              nullable: true
        - column:
            name: status
            type: inquiry_status
            constraints:
              nullable: false
        - column:
            name: created_date
            type: TIMESTAMP WITH TIME ZONE
            defaultValueComputed: CURRENT_TIMESTAMP
        - column:
            name: updated_date
            type: TIMESTAMP WITH TIME ZONE
- changeSet:
    id: DP-0001-1_08_createTable-payment
    author: daniel
    changes:
    - createTable:
        tableName: payment
        columns:
        - column:
            name: id
            type: BIGINT
            autoIncrement: true
            constraints:
              primaryKey: true
              primaryKeyName: pk_payment
              nullable: false
        - column:
            name: merchant_id
            type: BIGINT
            constraints:
              nullable: false
              foreignKeyName: fk_payment_x_merchant
              references: merchant(id)
        - column:
            name: inquiry_id
            type: BIGINT
            constraints:
              nullable: false
              foreignKeyName: fk_payment_x_inquiry
              references: inquiry(id)
        - column:
            name: invoice_number
            type: VARCHAR(64)
            constraints:
              nullable: false
        - column:
            name: virtual_account_number
            type: VARCHAR(28)
            constraints:
              nullable: false
        - column:
            name: virtual_account_name
            type: VARCHAR(255)
            constraints:
              nullable: false
        - column:
            name: virtual_account_email
            type: VARCHAR(255)
            constraints:
              nullable: true
        - column:
            name: virtual_account_phone
            type: VARCHAR(30)
            constraints:
              nullable: true
        - column:
            name: amount
            type: NUMERIC(16, 2)
            constraints:
              nullable: false
        - column:
            name: currency
            type: VARCHAR(3)
            constraints:
              nullable: false
        - column:
            name: additional_info
            type: JSONB
            constraints:
              nullable: true
        - column:
            name: status
            type: payment_status
            constraints:
              nullable: false
        - column:
            name: created_date
            type: TIMESTAMP WITH TIME ZONE
            defaultValueComputed: CURRENT_TIMESTAMP
        - column:
            name: updated_date
            type: TIMESTAMP WITH TIME ZONE
- changeSet:
    id: DP-0001-1_01_insert-merchant
    author: daniel
    changes:
    - sqlFile:
        path: db/data/DP-0001-1/DP-0001-1_01_insert-merchant.sql
        encoding: utf-8
        splitStatements: false
        stripComments: true
    rollback:
    - sqlFile:
        path: db/data/DP-0001-1/DP-0001-1_01_insert-merchant_ROLLBACK.sql
        splitStatements: false
